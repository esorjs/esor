var D=Object.defineProperty;var U=e=>{throw TypeError(e)};var se=(e,t,n)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var o=(e,t)=>D(e,"name",{value:t,configurable:!0});var C=(e,t,n)=>se(e,typeof t!="symbol"?t+"":t,n),fe=(e,t,n)=>t.has(e)||U("Cannot "+n);var W=(e,t,n)=>(fe(e,t,"read from private field"),n?n.call(e):t.get(e)),B=(e,t,n)=>t.has(e)?U("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);var l=null,ue=0,$=[],d=o(e=>{let t=e,n=new Set;return o(i=>{if(i===void 0)return l&&n.add(l),t;let s=typeof i=="function"?i(t):i;if(!Object.is(s,t)){t=s;for(let S of n)S()}return t},"getterSetter")},"signal"),y=o(e=>{let t=!1,n=o(()=>{if(t)return;t=!0;let r=l;l=n;try{e()}finally{l=r,t=!1}},"reactive");return n(),()=>$.splice($.indexOf(n),1)},"effect"),w=o(e=>{let t=d();return y(()=>t(e())),()=>t()},"computed"),M=o(e=>{let t=l;l={id:ue++};try{return e()}finally{l=t}},"batch");function A(e,t,n=null){let r=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return n&&n.dispatchEvent(r),r}o(A,"emit");function V(e=null){let t=e;return n=>n!==void 0?t=n:t}o(V,"ref");function O(e){return e&&(e.__nodeGroups=!0),e}o(O,"markNode");function x(e){return E(e,O)}o(x,"markedFragment");function E(e,t=null,n=null){let r=document.createDocumentFragment();if(!e?.length)return r;for(let i of e)i&&(i=typeof t=="function"?t(i,r):i,Array.isArray(i)?r.appendChild(E(i,t)):r.appendChild(i));return n&&r.childNodes.length&&n.appendChild(r),r}o(E,"createFragment");function p(e,t,n="error"){let r=n==="warn"?console.warn:console.error,i=t instanceof Error?t:new Error(String(t));return r(`[Esor Framework Error] ${e}:`,i.message),i}o(p,"handleError");function u(e,t,n){try{return e()}catch(r){return p(t,r),n}}o(u,"tryCatch");function z(e,t){!e||!t||!t.parentNode||u(()=>{let n=t.parentNode,r=o(c=>{for(let f of c)!f||f.parentNode!==n||(f._cleanup&&typeof f._cleanup=="function"&&f._cleanup(),n.removeChild(f))},"removeNodes"),i=o((c,f)=>c.length!==f.length||c.some((m,g)=>!m.isEqualNode(f[g])),"nodesChanged"),s=t.__nodeGroups||[],S=new Map(s.map(c=>[c.key,c])),N=e.map((c,f)=>{let m=Array.isArray(c)?c.filter(Boolean):[c];return{key:m.find(ce=>ce?.getAttribute?.("key")!=null)?.getAttribute("key")||`__key_${f}`,nodes:m}}),ie=new Map(N.map(c=>[c.key,c]));for(let c of s)!ie.has(c.key)&&r(c.nodes);let b=t;for(let c of N){let f=S.get(c.key);if(f)if(i(f.nodes,c.nodes))r(f.nodes),n.insertBefore(x(c.nodes),b.nextSibling);else{let m=b.nextSibling;if(f.nodes[0]!==m){let g=document.createDocumentFragment();for(let j of f.nodes)g.appendChild(j);n.insertBefore(g,m)}c.nodes=f.nodes}else n.insertBefore(x(c.nodes),b.nextSibling);b=c.nodes[c.nodes.length-1]||b}t.__nodeGroups=N},"list.reconcile")}o(z,"reconcile");var T=new WeakMap,_="\uFEFF\uFEFF";function le(e,t,n=null){!e||!t||(n&&n.parentNode===t?t.insertBefore(e,n):t.appendChild(e))}o(le,"insertFragment");function pe(e,t){typeof t=="function"?t(e):t&&typeof t=="object"&&"current"in t?t.current=e:t!=null&&(t=e)}o(pe,"setRef");function ae(e,t,n){let r=t.slice(2).toLowerCase();e.addEventListener(r,n),e._cleanup=()=>e.removeEventListener(r,n)}o(ae,"setEvent");function me(e,t){Object.assign(e.style,t)}o(me,"setStyle");function I(e,t,n){t==="value"||t==="checked"?e[t]=n:n===!1||n===null||n===void 0?e.removeAttribute(t):e.setAttribute(t,n)}o(I,"setAttribute");function F(e,t){if(!e||typeof t!="function")return;let n=e._cleanup;n&&n();let r=y(t);return e._cleanup=r,r}o(F,"setEffect");function de(e,t){let n=e.parentNode,r=e.nextSibling;for(;r&&r.__nodeGroups;)r._cleanup&&r._cleanup(),n.removeChild(r),r=e.nextSibling;t?.length&&le(x(t),n,e.nextSibling)}o(de,"replaceNodes");function ye(e,t){let n=o(r=>{u(()=>{if(typeof r=="boolean"&&(r=""),Array.isArray(r))z(r,e);else{let i=document.createTextNode(String(r??""));O(i),de(e,[i])}},"html.updateContent")},"updateContent");typeof t=="function"?F(e,()=>n(t())):n(t)}o(ye,"setContent");var H=o((e,t,n)=>{t?(e.removeAttribute(t),t==="ref"?pe(e,n):t[0]=="o"&&t[1]=="n"?ae(e,t,n):t==="className"?e.setAttribute("class",n):t==="style"&&typeof n=="object"?F(e,()=>me(e,n)):typeof n=="function"?F(e,()=>I(e,t,n())):I(e,t,n)):ye(e,n)},"render");function he(e,t,n){let r=Array.from(e.attributes);for(let i of r)i.value===_&&H(e,i.name,t[n++]);return n}o(he,"processAttributes");function be(e,t,n){if(e.nodeValue===_){let r=document.createComment("");e.replaceWith(r),H(r,null,t[n++])}else{let r=P(e.nodeValue.replaceAll(_,"<!>"));for(let i of Array.from(r.content.childNodes))i.nodeType===8&&H(i,null,t[n++]);e.replaceWith(r.content)}return n}o(be,"processTextNode");function P(e){let t=document.createElement("template");return t.innerHTML=e,t}o(P,"createTemplate");function L(e,t=null){return u(()=>{let n=P(e);return typeof t=="function"&&t(n),[...n.content.childNodes]},"html.templateToNodes",[])}o(L,"templateToNodes");function ge(e){let t=[],n=document.createTreeWalker(e.content,5),r;for(;r=n.nextNode();)t.push(r);return t}o(ge,"collectNodes");function q(e,...t){return u(()=>e.length===1?L(e[0]):t.length?L(e.join(_),n=>{let r=ge(n),i=0;for(let s of r)s.nodeType===1&&s.attributes.length?i=he(s,t,i):s.nodeType===3&&s.nodeValue.includes(_)&&(i=be(s,t,i));return r}):L(e.join("")),"html.build",[])}o(q,"build");function G(e,...t){return T.has(e)?q(T.get(e),...t):(T.set(e,e),q(e,...t))}o(G,"html");var a=null,J=o(e=>a=e,"createLifecycle"),h=o((e,t)=>{if(!a){p("lifecycle","Hook called outside component setup");return}a._lifecycles[e]||(a._lifecycles[e]=[]),a._lifecycles[e].push(t)},"addHook"),k=o(e=>{if(a?._lifecycles?.[e])for(let t of a._lifecycles[e])queueMicrotask(()=>u(()=>t.call(a),"lifecycle.runHook"))},"runHook"),X=o(e=>{let t=e();return typeof t=="function"?h("destroy",t):()=>{}},"onEffect"),v=o(e=>h("beforeMount",e),"beforeMount"),Q=o(e=>h("mount",e),"onMount"),Y=o(e=>h("beforeUpdate",e),"beforeUpdate"),Z=o(e=>h("update",e),"onUpdate"),R=o(e=>h("destroy",e),"onDestroy");var K=o(e=>e==null?"":String(e).replace(/[&<>'"]/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[t]),"sanitizeHtml");var xe={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0};function ee(e){if(typeof e!="string")return e;let t=e.trim(),n=t.toLowerCase();return xe[n]??(/^[\d.]+$/.test(t)?parseFloat(t):t[0]==="{"||t[0]==="["?_e(t):t)}o(ee,"parseValue");function _e(e){try{return JSON.parse(e)}catch{}}o(_e,"parseJson");var te=o(e=>e.startsWith("ref")||e.startsWith("on"),"shouldSkipAttribute"),Ce=o(e=>{let t=e.attributes;for(let n=0;n<t.length;n++){let{name:r,value:i}=t[n];te(r)||(e.props[r]=d(ee(K(i))))}},"initAttributes"),Ae=o(e=>{let t=new MutationObserver(n=>{for(let r of n){let i=r.attributeName;if(!i||te(i))continue;let s=e.props[i];s&&s(ee(e.getAttribute(i)||""))}});t.observe(e,{attributes:!0}),e._cleanup.push(()=>t.disconnect())},"observeAttributes"),ne=o(e=>{u(()=>{Ce(e),Ae(e)},"props.initPropsAndObserve")},"initPropsAndObserve");function oe(e){e&&(e.emit=(t,n)=>A(t,n,e))}o(oe,"initDispatch");var Ee=/^[a-z][a-z0-9-]*$/,ke="open",Se=o((e,{mode:t}={})=>{var n,r;return r=class extends HTMLElement{constructor(){super();B(this,n,this.attachShadow({mode:t||ke}));C(this,"props",Object.create(null));C(this,"_lifecycles",{beforeMount:[],mount:[],beforeUpdate:[],update:[],destroy:[]});C(this,"_cleanup",[]);u(()=>{J(this),oe(this),ne(this);let s=e?.call(this,this.props);E(s||[],null,W(this,n)),k("beforeMount")},"component.init")}connectedCallback(){k("mount")}disconnectedCallback(){k("destroy");for(let s=this._cleanup.length-1;s>=0;s--)u(this._cleanup[s],"component.cleanup");this._cleanup.length=0}},n=new WeakMap,r},"BaseComponent"),re=o((e,t,n={})=>{if(!Ee.test(e))return p("component",`Invalid tag name: ${e}`,"error");if(customElements.get(e))return p("component",`${e} ya registrado`,"warn");typeof customElements<"u"&&customElements.define(e,Se(t,n))},"component");export{M as batch,v as beforeMount,Y as beforeUpdate,re as component,w as computed,y as effect,A as emit,p as handleError,G as html,R as onDestroy,X as onEffect,Q as onMount,Z as onUpdate,V as ref,d as signal,u as tryCatch};
//# sourceMappingURL=esor.min.js.map
