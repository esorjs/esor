var F=Object.defineProperty;var U=e=>{throw TypeError(e)};var re=(e,t,n)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var r=(e,t)=>F(e,"name",{value:t,configurable:!0});var M=(e,t,n)=>re(e,typeof t!="symbol"?t+"":t,n),B=(e,t,n)=>t.has(e)||U("Cannot "+n);var C=(e,t,n)=>(B(e,t,"read from private field"),n?n.call(e):t.get(e)),T=(e,t,n)=>t.has(e)?U("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),S=(e,t,n,o)=>(B(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);var d=null,N=0,k=new Set,y=r(e=>{let t=e,n=[],o=r(s=>{if(s===void 0)return d&&!n.includes(d)&&(n.push(d),d.subs&&d.subs.add(o)),t;let f=typeof s=="function"?s(t):s;if(!Object.is(f,t))if(t=f,N>0)for(let i=0;i<n.length;i++)k.add(n[i]);else{let i=n.slice();for(let u=0;u<i.length;u++)i[u]()}return t},"getterSetter");return o.subs=n,o},"signal"),m=r(e=>{let t=new Set,n=!1,o=r(()=>{if(n)return;n=!0;let s=d;d=o;try{e()}finally{d=s,n=!1}},"reactive");return o.subs=t,o(),()=>{t.forEach(s=>{let f=s.subs.indexOf(o);f!==-1&&s.subs.splice(f,1)}),t.clear()}},"effect"),O=r(e=>{let t=y(e());return m(()=>t(e())),()=>t()},"computed"),H=r(e=>{N++;try{return e()}finally{if(N--,N===0){let t=Array.from(k);k.clear(),t.forEach(n=>n())}}},"batch");function A(e,t,n=null){let o=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return n&&n.dispatchEvent(o),o}r(A,"emit");function R(e=null){let t=e;return n=>n!==void 0?t=n:t}r(R,"ref");var $=r(e=>e==null?"":String(e).replace(/[&<>'"]/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[t]),"sanitizeHtml");function a(e,t=null){let n=document.createDocumentFragment();if(!e?.length)return n;let o=!1,s=null;t&&typeof t=="object"&&(o=!!t.mark,s=t.parent||null);for(let f of e)f&&(o&&f&&(f.__nodeGroups=!0),Array.isArray(f)?n.appendChild(a(f,t)):n.appendChild(f));return s&&n.childNodes.length&&s.appendChild(n),n}r(a,"createFragment");function V(e,t){if(!e||!t||!t.parentNode)return;let n=t.parentNode,o=r(c=>{for(let l of c)!l||l.parentNode!==n||(l._cleanup&&typeof l._cleanup=="function"&&l._cleanup(),n.removeChild(l))},"removeNodes"),s=r((c,l)=>c.length!==l.length||c.some((b,W)=>!b.isEqualNode(l[W])),"nodesChanged"),f=t.__nodeGroups||[],i=new Map(f.map(c=>[c.key,c])),u=e.map((c,l)=>{let b=Array.isArray(c)?c.filter(Boolean):[c];return{key:b.find(oe=>oe?.getAttribute?.("key")!=null)?.getAttribute("key")||`__key_${l}`,nodes:b}}),_=new Map(u.map(c=>[c.key,c]));for(let c of f)!_.has(c.key)&&o(c.nodes);let p=t;for(let c of u){let l=i.get(c.key);if(l)if(s(l.nodes,c.nodes))o(l.nodes),n.insertBefore(a(c.nodes,{mark:!0}),p.nextSibling);else{let b=p.nextSibling;l.nodes[0]!==b&&n.insertBefore(a(l.nodes),b),c.nodes=l.nodes}else n.insertBefore(a(c.nodes,{mark:!0}),p.nextSibling);p=c.nodes[c.nodes.length-1]||p}t.__nodeGroups=u}r(V,"reconcile");var D=new WeakMap,E="\uFEFF",G=r((e,t,n)=>{if(t)if(e.removeAttribute(t),t==="ref")typeof n=="function"?n(e):n&&(n.current=e);else if(t[0]=="o"&&t[1]=="n"&&typeof n=="function"){let o=t.slice(2).toLowerCase();e.addEventListener(o,n),e._cleanup=()=>e.removeEventListener(o,n)}else t==="style"&&typeof n=="object"?m(()=>Object.assign(e.style,n)):typeof n=="function"?m(()=>z(e,t,n())):z(e,t,n);else ce(e,n)},"render");function z(e,t,n){t==="value"||t==="checked"?e[t]=n:n===!1||n===null||n===void 0?e.removeAttribute(t):e.setAttribute(t,n)}r(z,"setAttribute");function se(e,t){let n=e.parentNode,o=e.nextSibling;for(;o&&o.__nodeGroups;)o._cleanup&&o._cleanup(),n.removeChild(o),o=e.nextSibling;t?.length&&ie(a(t,{mark:!0}),n,e.nextSibling)}r(se,"replaceNodes");function ce(e,t){let n=r(o=>{if(typeof o=="boolean"&&(o=""),Array.isArray(o))V(o,e);else{let s=document.createTextNode($(typeof o=="string"?o:String(o??"")));se(e,[s])}},"updateContent");typeof t=="function"?m(()=>n(t())):n(t)}r(ce,"setContent");function ie(e,t,n=null){!e||!t||(n&&n.parentNode===t?t.insertBefore(e,n):t.appendChild(e))}r(ie,"insertFragment");function j(e){let t=document.createElement("template");return t.innerHTML=e,t}r(j,"createTemplate");function fe(e,t){let n=[],o=document.createTreeWalker(e.content,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);for(;o.nextNode();)n.push(o.currentNode);let s=0;for(let f=0;f<n.length;f++){let i=n[f];if(i.nodeType===Node.ELEMENT_NODE&&i.attributes.length)for(let u of Array.from(i.attributes))u.value===E&&G(i,u.name,t[s++]);else if(i.nodeType===Node.TEXT_NODE&&i.nodeValue.includes(E))if(i.nodeValue===E){let u=document.createComment("");i.parentNode.replaceChild(u,i),G(u,null,t[s++])}else{let u=j(i.nodeValue.replaceAll(E,"<!>")),_=Array.from(u.content.childNodes);for(let p=0;p<_.length;p++){let c=_[p];c.nodeType===Node.COMMENT_NODE&&G(c,null,t[s++])}i.parentNode.replaceChild(u.content,i)}}}r(fe,"processTemplate");function X(e,t=null){let n=j(e);return typeof t=="function"&&t(n),[...n.content.childNodes]}r(X,"templateToNodes");function q(e,...t){if(e.length===1)return X(e[0]);if(!t.length)return X(e.join(""));let n=e.join(E),o=j(n);return fe(o,t),[...o.content.childNodes]}r(q,"build");function L(e,...t){return D.has(e)?q(D.get(e),...t):(D.set(e,e),q(e,...t))}r(L,"html");function x(e,t,n="error"){let o=n==="warn"?console.warn:console.error,s=t instanceof Error?t:new Error(String(t));return o(`[Esor Error] ${e}:`,s.message),s}r(x,"handleError");var h=null,P=r(e=>h=e,"createLifecycle"),g=r((e,t)=>{if(!h){x("lifecycle","Hook called outside component setup");return}h._lifecycles[e]||(h._lifecycles[e]=[]),h._lifecycles[e].push(t)},"addHook"),w=r(e=>{if(h?._lifecycles?.[e])for(let t of h._lifecycles[e])queueMicrotask(()=>t.call(h),"lifecycle.runHook")},"runHook"),I=r(e=>{let t=e();return typeof t=="function"?g("destroy",t):()=>{}},"onEffect"),J=r(e=>g("beforeMount",e),"beforeMount"),K=r(e=>g("mount",e),"onMount"),Q=r(e=>g("beforeUpdate",e),"beforeUpdate"),Y=r(e=>g("update",e),"onUpdate"),Z=r(e=>g("destroy",e),"onDestroy");var le=/^-?\d+(?:\.\d+)?(?:e[+-]?\d+)?$/;function v(e){if(e==null)return"";if(e==="true")return!0;if(e==="false")return!1;if(le.test(e))return Number(e);if(typeof e=="string"&&(e[0]==="{"||e[0]==="["))try{return JSON.parse(e)}catch{}return e}r(v,"parseAttributeValue");function ee(e){for(let n of e.attributes){let{name:o,value:s}=n;o.startsWith("on")||o.startsWith("ref")||(e.props[o]=y(v(s)))}let t=new MutationObserver(n=>{for(let o of n){let s=o.attributeName;if(!s||s.startsWith("on")||s.startsWith("ref"))continue;let f=e.props[s];f&&f(v(e.getAttribute(s)))}});t.observe(e,{attributes:!0}),e._cleanup.push(()=>t.disconnect())}r(ee,"initPropsAndObserve");function te(e){e&&(e.emit=(t,n)=>A(t,n,e))}r(te,"initDispatch");var ue=/^[a-z][a-z0-9-]*$/,pe="open",ae=r((e,t={})=>{var n,o,s;return s=class extends HTMLElement{constructor(){super();T(this,n,this.attachShadow({mode:t.mode||pe}));T(this,o,!1);M(this,"props",Object.create(null));M(this,"_lifecycles",{beforeMount:[],mount:[],beforeUpdate:[],update:[],destroy:[]});M(this,"_cleanup",[]);P(this),te(this),ee(this);let i=e?.call(this,this.props);a(i||[i],{parent:C(this,n)}),w("beforeMount")}connectedCallback(){C(this,o)||(S(this,o,!0),w("mount"))}disconnectedCallback(){w("destroy"),this._cleanup.forEach(i=>i()),this._cleanup=[],S(this,o,!1)}},n=new WeakMap,o=new WeakMap,s},"BaseComponent"),ne=r((e,t,n={})=>{if(!(typeof customElements>"u")){if(!ue.test(e))return x("component",`Invalid tag name: ${e}`,"error");if(customElements.get(e))return x("component",`${e} already registered`,"warn");customElements.define(e,ae(t,n))}},"component");export{H as batch,J as beforeMount,Q as beforeUpdate,ne as component,O as computed,m as effect,A as emit,L as html,Z as onDestroy,I as onEffect,K as onMount,Y as onUpdate,R as ref,y as signal};
//# sourceMappingURL=esor.min.js.map
