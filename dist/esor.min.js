var se=Object.defineProperty;var ce=e=>{throw TypeError(e)};var st=(e,t,n)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var i=(e,t)=>se(e,"name",{value:t,configurable:!0});var fe=(e,t,n)=>st(e,typeof t!="symbol"?t+"":t,n),ae=(e,t,n)=>t.has(e)||ce("Cannot "+n);var S=(e,t,n)=>(ae(e,t,"read from private field"),n?n.call(e):t.get(e)),z=(e,t,n)=>t.has(e)?ce("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);var ue=(e,t,n)=>(ae(e,t,"access private method"),n);var x,O,de,$=class ${constructor(){z(this,O);z(this,x,new Map);$.current=this}add(t,n){return ue(this,O,de).call(this,t).add(n),()=>S(this,x).get(t)?.delete(n)}run(t,n){let o=S(this,x).get(t);if(o?.size)for(let s of o)try{s.call(n)}catch(f){(typeof n._catchError=="function"?n._catchError:console.error)("Error in lifecycle hook:",f)}}clear(t){t?S(this,x).delete(t):S(this,x).clear()}};x=new WeakMap,O=new WeakSet,de=i(function(t){return S(this,x).has(t)||S(this,x).set(t,new Set),S(this,x).get(t)},"#hooks"),i($,"Lifecycle"),fe($,"current");var C=$,le=i(()=>C.current||(()=>{throw"Lifecycle not initialized"})(),"getLC"),[pe,ge,me,he,ve]=["beforeMount","mount","beforeUpdate","update","destroy"].map(e=>t=>le().add(e,t)),Ee=i(e=>{let t=e();return t instanceof Function&&le().add("destroy",t)||(()=>{})},"onEffect");var B={currentEffect:null,currentComponent:null,pendingEffects:new Set,isEffectsFlushing:!1,globalEvents:{handlersByType:new Map,nextId:0}},v=B;function R(e,t){let n=B.currentComponent;B.currentComponent=e;try{return t()}finally{B.currentComponent=n}}i(R,"withCurrentComponent");var X={info:{color:"#0066cc",icon:"\u2139\uFE0F"},warn:{color:"#FFA500",icon:"\u26A0\uFE0F"},error:{color:"#FF0000",icon:"\u{1F6AB}"}},G=i((e="info",t="",...n)=>{X[e]||(e="info");let o=e.charAt(0).toUpperCase()+e.slice(1);console.groupCollapsed(`%c[ESOR ${X[e].icon}${o}] ${t}`,`color: ${X[e].color}; font-weight: bold;`),console[e]({message:t,component:v.currentComponent?.constructor?.name||"Unknown",time:new Date().toISOString(),data:n.length?n:void 0}),console[e==="error"?"trace":"debug"](),console.groupEnd()},"log"),en=i((...e)=>G("info",...e),"info"),tn=i((...e)=>G("warn",...e),"warn"),A=i((...e)=>G("error",...e),"error");var N=new Map,ct=1;function ye(e,t){if(!e||typeof t!="function")return A("Invalid event registration parameters"),-1;N.has(e)||N.set(e,new Map);let n=ct++;return N.get(e).set(n,t),n}i(ye,"registerEvent");function xe(e,t){return N.get(e)?.get(t)}i(xe,"getEventHandler");function Te(e,t){let n=N.get(e);n&&(n.delete(t),n.size===0&&N.delete(e))}i(Te,"clearEventHandler");function be(e,t){let n=v.currentComponent;if(!n)return A("useEmit must be used within a component"),null;let o=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return o.__esor={name:e,detail:t,receivedBy:[],timestamp:Date.now()},n.dispatchEvent(o),o}i(be,"useEmit");var J=i(e=>e==null?"":e.toString().replace(/[&<>'"]/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;","/":"&#x2F;"})[t]),"escapeHTML");function Se(e){return e==null?"":String(e).replace(/^["']|["']$/g,"").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}i(Se,"cleanAttributeValue");var Ae="$:",T="data_esor_event",K="data_esor_bind",Q="data_esor_ref",ft=new RegExp(/\s(\w[\w-]*)=(["'])?(?:(?!\2).)*$/),_e=new RegExp(/ref=(["'])?\s*$/),Ne=new RegExp(/(@\w+)=(["'])?\s*$/),at=new RegExp(/["']\s*$/),ut=new RegExp(/^(script|style|textarea|title)$/i);function we(e,t,n,o){let s=e&&e.charAt(e.length-1)==='"'?'"':"'";return e.replace(t,`${n}=${s}${o}${s}`)}i(we,"replaceAttribute");var lt=i(e=>e.replace(at,""),"removeQuote"),dt=i(e=>e?.template?.nodeType===Node.DOCUMENT_FRAGMENT_NODE,"isTemplateObject");function pt(e,t,n){let o=ye(t,e);return we(n,Ne,`${T}-${t}`,o)}i(pt,"injectEvent");function gt(e,t,n,o){return o.set(n,e),we(t,_e,`${Q}-${n}`,n)}i(gt,"injectRef");function mt(e,t,n,o,s){n=lt(n);let f=n&&n.charAt(n.length-1)==='"'?'"':"'",c=typeof e=="function"?e():e,u=ut.test(t)?String(c):J(c),g=`${K}-${o}`;return n+=`${f}${u}${f} ${g}=${f}true${f}`,s.set(o,{type:"attribute",signal:e,attributeName:t,bindAttr:g}),n}i(mt,"injectSignalAttr");function Ce(e,t,n,o,s){let f=`${Ae}${o}`;s.set(o,{type:t?"expression":"text",signal:e,bindAttr:f});let c=t?e():e;return`${n}<!--${f}-->${J(String(c))}<!--//${f}-->`}i(Ce,"injectExpr");function $e(e,t,n,o,s,f){let c=`${Ae}${t}`,u={type:"array",signal:s?()=>(e.__signal()||[]).map(e.__mapFn||(a=>a)):typeof f=="function"?f:()=>e,bindAttr:c};n.set(t,u);let r=(Array.isArray(e)?e:[]).map(P).join("");return`${o}<!--${c}-->${r}<!--//${c}-->`}i($e,"injectArray");function ht(e){let t="";for(let n of e.childNodes)n.nodeType===Node.ELEMENT_NODE&&n.hasAttribute("key")&&(n.setAttribute("data-key",n.getAttribute("key")),n.removeAttribute("key")),t+=n.outerHTML||n.textContent;return t}i(ht,"processTemplateNodes");function P(e){return e==null||e===!1?"":Array.isArray(e)?e.reduce((t,n)=>t+P(n),""):e instanceof SVGElement?e.outerHTML:dt(e)?ht(e.template):e?.type==="template-array"?e.templates.reduce((t,n)=>t+P(n),""):e.toString()}i(P,"processVal");function vt(e,...t){let n="",o=new Map,s=new Map,f=0,c=0;for(let g=0;g<e.length;g++){if(n+=e[g],g>=t.length)continue;let r=t[g],a=e[g].match(ft),l=!!a,p=a?.[1],d=_e.exec(n),m=Ne.exec(n),E=d&&typeof r=="function",w=m&&typeof r=="function",it=w?m[1].slice(1):null;E?n=gt(r,n,c++,s):w?n=pt(r,it,n):(r?.signal||typeof r=="function")&&l?n=mt(r,p,n,f++,o):Array.isArray(r)&&r.__signalArray===!0?n=$e(r,f++,o,n,!0):r?.signal?n=Ce(r,!1,n,f++,o):typeof r=="function"?n=Ce(r,!0,n,f++,o):Array.isArray(r)?n=$e(r,f++,o,n,!1,r):r!=null&&(n+=P(r))}let u=document.createElement("template");return u.innerHTML=n.trim(),{template:u.content,signals:o,refs:s}}i(vt,"processTemplate");function Re(e,...t){return vt(e,...t)}i(Re,"html");function hn(e,t){return!Object.is(e,t)}i(hn,"valuesChanged");var De=i(e=>e instanceof DocumentFragment&&e||e?.content?.cloneNode()||document.createDocumentFragment(),"getDocumentFragment");function Me(e,t){let n=e.nextSibling;for(;n&&n!==t;){let o=n.nextSibling;n.parentNode.removeChild(n),n=o}}i(Me,"removeChildNodesBetween");var k=new WeakMap;function F(e,t){if(k.has(e)){let c=k.get(e)[t];if(c)return c}let n=document.createTreeWalker(e,NodeFilter.SHOW_COMMENT),o=null,s=null;for(;n.nextNode()&&!s;){let c=n.currentNode;!o&&c.nodeValue===t?o=c:o&&c.nodeValue===`//${t}`&&(s=c)}let f=[o,s];return k.set(e,{...k.get(e),[t]:f}),f}i(F,"findCommentPlaceholders");function Ie(e){let n=HTMLElement.prototype.hasOwnProperty("attachInternals")?e.attachInternals():null;n?.shadowRoot?e.shadowRoot=n.shadowRoot:e.attachShadow({mode:"open"})}i(Ie,"setupDeclarativeShadowRoot");function Oe(e,t=[Q,T,K]){let n={},o=document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT,{acceptNode(f){if(f.hasAttributes()){for(let{name:c}of f.attributes)if(t.some(u=>c.startsWith(u)))return NodeFilter.FILTER_ACCEPT}return NodeFilter.FILTER_SKIP}}),s;for(;s=o.nextNode();)for(let f of s.attributes){let c=t.find(u=>f.name.startsWith(u));c&&(n[c]||(n[c]=[]),n[c].push(f))}return Object.keys(n).length?n:null}i(Oe,"findAttributesWithEsorDirectives");var Be=(e=>(e[e.Computed=1]="Computed",e[e.Effect=2]="Effect",e[e.Tracking=4]="Tracking",e[e.Notified=8]="Notified",e[e.Recursed=16]="Recursed",e[e.Dirty=32]="Dirty",e[e.PendingComputed=64]="PendingComputed",e[e.PendingEffect=128]="PendingEffect",e[e.Propagated=224]="Propagated",e))(Be||{});function Pe({updateComputed:e,notifyEffect:t}){let n,o;return{link(r,a){let l=a.depsTail;if(l!==void 0&&l.dep===r)return;let p=l!==void 0?l.nextDep:a.deps;if(p!==void 0&&p.dep===r){a.depsTail=p;return}let d=r.subsTail;if(!(d!==void 0&&d.sub===a&&u(d,a)))return s(r,a,p,l)},propagate(r){let a=32,l=r,p=0;e:do{let d=r.sub,m=d.flags;if(!(m&244)&&(d.flags=m|a|8,!0)||m&16&&!(m&4)&&(d.flags=m&-17|a|8,!0)||!(m&224)&&u(r,d)&&(d.flags=m|16|a|8,d.subs!==void 0)){let E=d.subs;if(E!==void 0){E.nextSub!==void 0?(E.prevSub=l,r=l=E,a=64,++p):(r=E,a=m&2?128:64);continue}m&2&&(o!==void 0?o.depsTail.nextDep=d.deps:n=d,o=d)}else m&(4|a)?!(m&a)&&m&224&&u(r,d)&&(d.flags=m|a):(d.flags=m|a|8,(m&10)===2&&(o!==void 0?o.depsTail.nextDep=d.deps:n=d,o=d));if((r=l.nextSub)!==void 0){l=r,a=p?64:32;continue}for(;p;){--p;let w=l.dep.subs;if(l=w.prevSub,w.prevSub=void 0,(r=l.nextSub)!==void 0){l=r,a=p?64:32;continue e}}break}while(!0)},startTracking(r){r.depsTail=void 0,r.flags=r.flags&-249|4},endTracking(r){let a=r.depsTail;if(a!==void 0){let l=a.nextDep;l!==void 0&&(g(l),a.nextDep=void 0)}else r.deps!==void 0&&(g(r.deps),r.deps=void 0);r.flags&=-5},updateDirtyFlag(r,a){return f(r.deps)?(r.flags=a|32,!0):(r.flags=a&-65,!1)},processComputedUpdate(r,a){if((a&32||(f(r.deps)||(r.flags=a&-65,!1)))&&e(r)){let l=r.subs;l!==void 0&&c(l)}},processPendingInnerEffects(r,a){if(a&128){r.flags=a&-129;let l=r.deps;do{let p=l.dep;"flags"in p&&p.flags&2&&p.flags&224&&t(p),l=l.nextDep}while(l!==void 0)}},processEffectNotifications(){for(;n!==void 0;){let r=n,a=r.depsTail,l=a.nextDep;l!==void 0?(a.nextDep=void 0,n=l.sub):(n=void 0,o=void 0),t(r)||(r.flags&=-9)}}};function s(r,a,l,p){let d={dep:r,sub:a,nextDep:l,prevSub:void 0,nextSub:void 0};if(p===void 0?a.deps=d:p.nextDep=d,r.subs===void 0)r.subs=d;else{let m=r.subsTail;d.prevSub=m,m.nextSub=d}return a.depsTail=d,r.subsTail=d,d}function f(r){let a=0,l;e:do{l=!1;let p=r.dep;if("flags"in p){let d=p.flags;if((d&33)===33){if(e(p)){let m=p.subs;m.nextSub!==void 0&&c(m),l=!0}}else if((d&65)===65){let m=p.subs;m.nextSub!==void 0&&(m.prevSub=r),r=p.deps,++a;continue}}if(!l&&r.nextDep!==void 0){r=r.nextDep;continue}if(a){let d=r.sub;do{--a;let m=d.subs;if(l){if(e(d)){(r=m.prevSub)!==void 0?(m.prevSub=void 0,c(m),d=r.sub):d=m.sub;continue}}else d.flags&=-65;if((r=m.prevSub)!==void 0){if(m.prevSub=void 0,r.nextDep!==void 0){r=r.nextDep;continue e}d=r.sub}else{if((r=m.nextDep)!==void 0)continue e;d=m.sub}l=!1}while(a)}return l}while(!0)}function c(r){do{let a=r.sub,l=a.flags;(l&96)===64&&(a.flags=l|32|8,(l&10)===2&&(o!==void 0?o.depsTail.nextDep=a.deps:n=a,o=a)),r=r.nextSub}while(r!==void 0)}function u(r,a){let l=a.depsTail;if(l!==void 0){let p=a.deps;do{if(p===r)return!0;if(p===l)break;p=p.nextDep}while(p!==void 0)}return!1}function g(r){do{let a=r.dep,l=r.nextDep,p=r.nextSub,d=r.prevSub;if(p!==void 0?p.prevSub=d:a.subsTail=d,d!==void 0?d.nextSub=p:a.subs=p,a.subs===void 0&&"deps"in a){let m=a.flags;m&32||(a.flags=m|32);let E=a.deps;if(E!==void 0){r=E,a.depsTail.nextDep=l,a.deps=void 0,a.depsTail=void 0;continue}}r=l}while(r!==void 0)}}i(Pe,"createReactiveSystem");var{link:D,propagate:Et,updateDirtyFlag:yt,startTracking:V,endTracking:H,processEffectNotifications:ke,processComputedUpdate:xt,processPendingInnerEffects:Fe}=Pe({updateComputed(e){let t=h;h=e,V(e);try{let n=e.currentValue,o=e.getter(n);return n!==o?(e.currentValue=o,!0):!1}finally{h=t,H(e)}},notifyEffect(e){return"isScope"in e?Nt(e):_t(e)}}),Ve=[],Y=0,h,_;function Z(){++Y}i(Z,"startBatch");function ee(){--Y||ke()}i(ee,"endBatch");function Tt(){Ve.push(h),h=void 0}i(Tt,"pauseTracking");function bt(){h=Ve.pop()}i(bt,"resumeTracking");function U(e){return Ct.bind({currentValue:e,subs:void 0,subsTail:void 0})}i(U,"signal");function M(e){return wt.bind({currentValue:void 0,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:33,getter:e})}i(M,"computed");function y(e){let t={fn:e,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:2};return h!==void 0?D(t,h):_!==void 0&&D(t,_),He(t),Ue.bind(t)}i(y,"effect");function St(e){let t={deps:void 0,depsTail:void 0,flags:2,isScope:!0};return At(t,e),Ue.bind(t)}i(St,"effectScope");function He(e){let t=h;h=e,V(e);try{e.fn()}finally{h=t,H(e)}}i(He,"runEffect");function At(e,t){let n=_;_=e,V(e);try{t()}finally{_=n,H(e)}}i(At,"runEffectScope");function _t(e){let t=e.flags;return t&32||t&64&&yt(e,t)?He(e):Fe(e,e.flags),!0}i(_t,"notifyEffect");function Nt(e){return e.flags&128?(Fe(e,e.flags),!0):!1}i(Nt,"notifyEffectScope");function wt(){let e=this.flags;return e&96&&xt(this,e),h!==void 0?D(this,h):_!==void 0&&D(this,_),this.currentValue}i(wt,"computedGetter");function Ct(...e){if(e.length){if(this.currentValue!==(this.currentValue=e[0])){let t=this.subs;t!==void 0&&(Et(t),Y||ke())}}else return h!==void 0&&D(this,h),this.currentValue}i(Ct,"signalGetterSetter");function Ue(){V(this),H(this)}i(Ue,"effectStop");function W(e,t){return e&&e.__signalArray===!0?e:new Proxy(e,{get(n,o,s){let f=Reflect.get(n,o,s);return typeof f=="function"?function(...c){let u=f.apply(n,c);return Array.isArray(u)?(u.__signalArray=!0,u.__signal=t,c.length>0&&typeof c[0]=="function"&&(u.__mapFn=c[0]),W(u,t)):u}:f}})}i(W,"wrapArray");function b(e){if(Array.isArray(e)){let t=U(e),n=W(e,()=>t());return n.__signalArray=!0,i((...s)=>{if(s.length>0){let f=s[0];return t(f),n=W(f,()=>t()),n.__signalArray=!0,n}return n},"func")}return U(e)}i(b,"signal");function te(e){if(v.batchActive)return e();v.batchActive=!0,Z();try{return e()}finally{ee(),v.batchActive=!1}}i(te,"batch");function ze(e,t,n,o,s){n=[...n||[]],o=[...o||[]];let f=t.parentNode,c=$t(e,t),u=Mt(o,c,n);Bt(f,c,u,t),Xe(s,e,t),e.__oldItems=[...o]}i(ze,"reconcileArrays");function $t(e,t){let n=[],o=e.nextSibling;for(;o&&o!==t;)n.push(o),o=o.nextSibling;return n}i($t,"collectNodes");function I(e){return e&&e.nodeType===Node.ELEMENT_NODE}i(I,"isValidDOMNode");function Rt(e){return I(e)?e.getAttribute("data-key"):null}i(Rt,"getNodeKey");function Dt(e,t,n,o){if(!e||!t||!n?.template||!o?.template)return!1;e.firstChild?.nodeType===3&&e.normalize(),t.firstChild?.nodeType===3&&t.normalize();let s=We(e),f=We(t);if(s.length!==f.length)return!1;let c=!1;for(let u=0,g=s.length;u<g;u++){let r=s[u].textContent,a=f[u].textContent;r!==a&&(s[u].textContent=a,c=!0)}return c}i(Dt,"updateNodeContent");function We(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),o;for(;o=n.nextNode();)t.push(o);return t}i(We,"getTextNodes");function Mt(e,t,n){let o=new Map,s=new Map,f=[e.length];for(let c=0,u=t.length;c<u;c++){let g=Rt(t[c]);g&&o.set(g,t[c])}for(let c=0,u=n.length;c<u;c++)s.set(Le(n[c],c),n[c]);for(let c=0,u=e.length;c<u;c++)f[c]=Le(e[c],c);return e.map((c,u)=>{let g=f[u],r=o.get(g),a=s.get(g);if(r?.nodeType===1){if(!a||It(a,c)){let l=qe(c,g);return Dt(r,l,a,c)?(Ot(r,l),r):l}return r}return qe(c,g)})}i(Mt,"createOrReuseNodes");function It(e,t){if(!e||!t)return!0;if(e?.template&&t?.template){let n=je(e),o=je(t);return!j(n,o)}return!j(e,t)}i(It,"hasChanged");function je(e){let t=e?.template;if(!t)return null;let n=[],o=t.cloneNode(!0),s=document.createTreeWalker(o,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode(c){return c.nodeType===3?c.textContent.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}}),f;for(;f=s.nextNode();)if(f.nodeType===3)n.push(f.textContent);else{let c=f.attributes;for(let u=0,g=c.length;u<g;u++){let r=c[u].value;r.includes("${")&&(n[n.length]=r)}}return n}i(je,"extractDynamicValues");function j(e,t){if(e===t)return!0;if(!e||!t||typeof e!=typeof t)return!1;if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((n,o)=>j(n,t[o]));if(typeof e=="object"){let n=Object.keys(e),o=Object.keys(t);return n.length!==o.length?!1:n.every(s=>j(e[s],t[s]))}return String(e)===String(t)}i(j,"areValuesEqual");function Ot(e,t){if(!I(e)||!I(t))return;let n=e.attributes;for(let o=n.length;o--;){let s=n[o];s.name.lastIndexOf(T,0)===0&&t.setAttribute(s.name,s.value)}}i(Ot,"copyEventAttributes");function Le(e,t){if(e?.key!==void 0)return`key-${e.key}`;if(e?.template){let n=e.template.firstElementChild;if(e.id)return`item-${e.id}`;if(n&&I(n)){let o=n.getAttribute("key");if(o)return o}return`template-${t}`}if(e&&typeof e=="object"){if(e.id)return`item-${e.id}`;try{return`item-${t}-${JSON.stringify(e)}`}catch{return`item-${t}`}}return`item-${t}-${String(e)}`}i(Le,"getItemKey");function qe(e,t){let n;return e?.template?n=e.template.cloneNode(!0).firstElementChild||document.createElement("div"):(n=document.createElement("div"),n.textContent=String(e)),I(n)&&n.setAttribute("data-key",t),n}i(qe,"createNode");var Rn=i((e,t,n)=>{try{return e.moveBefore(t,n)}catch{return e.insertBefore(t,n)}},"moveBefore");function Bt(e,t,n,o){let s=0,f=t.length,c=0,u=n.length,g=f>0&&t[f-1].nextSibling||o,r=null;if(f===0){for(let a=0;a<u;a++)e.insertBefore(n[a],g);return}if(u===0){for(;s<f;){let a=t[s++];a instanceof Node&&e.removeChild(a)}return}for(;s<f||c<u;){if(t[s]===n[c]){s++,c++;continue}for(;t[f-1]===n[u-1];)f--,u--;if(s===f){let a=u<n.length?c?n[c-1].nextSibling:n[u-c]:g;for(;c<u;)e.insertBefore(n[c++],a)}else if(c===u)for(;s<f;)(!r||!r.has(t[s]))&&e.removeChild(t[s]),s++;else if(t[s]===n[u-1]&&n[c]===t[f-1]){let a=t[--f].nextSibling;e.insertBefore(n[c++],t[s++].nextSibling),e.insertBefore(n[--u],a),t[f]=n[u]}else{if(!r){r=new Map;for(let l=c;l<u;l++)r.set(n[l],l)}let a=r.get(t[s]);if(a==null)e.removeChild(t[s++]);else if(c<a&&a<u){let l=1;for(;s+l<f&&a+l<u&&t[s+l]===n[a+l];)l++;if(l>a-c){let p=t[s];for(;c<a;)e.insertBefore(n[c++],p)}else e.replaceChild(n[c++],t[s++])}else s++}}}i(Bt,"ddiff");function Ge(e,t){if(!e?.shadowRoot)throw new Error("Invalid instance or missing shadowRoot");let n=e.shadowRoot,o=new Map,s=new Set;for(let f of t){let c=f.name.replace(`${T}-`,"");c&&s.add(c)}for(let f of s){let c=i(u=>{let g=u.target,r=[];for(;g&&g!==n;)r.push(g),g=g.parentNode;for(let a of r){let l=a.getAttributeNode(`${T}-${f}`);if(!l)continue;let p=Number(l.value),d=xe(f,p);if(typeof d=="function"){R(e,()=>{d.call(e,u)===!1&&u.stopPropagation()});break}}},"handler");n.addEventListener(f,c,{passive:!1,capture:!0}),o.set(f,c)}e._eventHandlers=o}i(Ge,"setupEventDelegation");function Je(e,t){if(!(!e||!t))for(let n of e){let o=n.ownerElement;if(!o)continue;let s=Number(n.value);o.removeAttribute(n.name);let f=t.get(s);typeof f=="function"&&f(o)}}i(Je,"setupRefs");function L(e,t,n){let o=y(()=>{if(!e._isUpdating){e._isUpdating=!0;try{n(t())}finally{e._isUpdating=!1}}});e._cleanup.add(o)}i(L,"bindSignalToElement");function Ke(e,t){if(!(!t||t.size===0))for(let{type:n,signal:o,bindAttr:s,attributeName:f}of t.values())switch(n){case"attribute":Pt(e,o,s,f);break;case"array":kt(e,o,s);break;case"text":case"expression":Qe({host:e,type:n,signal:o,bindAttr:s});break}}i(Ke,"setupSignals");function Pt(e,t,n,o){let s=e.shadowRoot.querySelector(`[${n}]`);s&&(s.removeAttribute(n),L(e,t,f=>{let c=String(f);s.getAttribute(o)!==c&&s.setAttribute(o,c)}))}i(Pt,"handleAttributeSignal");function kt(e,t,n){let[o,s]=F(e.shadowRoot,n);!o||!s||L(e,t,f=>{let c=o.__oldItems||[],u=Array.isArray(f)?f:[];ze(o,s,c,u,e)})}i(kt,"handleArraySignal");function Xe(e,t,n){let{shadowRoot:o}=e,s=Vt(o,t,n);Ft(e,s)}i(Xe,"bindEventsInRange");function Ft(e,t){for(let n of t)for(let o of Array.from(n.attributes)){if(!o.name.startsWith(`${T}`))continue;let s=o.name.replace(T,""),f=parseInt(o.value,10),c=v.globalEvents.handlersByType.get(s)?.get(f);typeof c=="function"&&(n.addEventListener(s,(...u)=>R(e,()=>c.call(e,...u))),n.removeAttribute(o.name))}}i(Ft,"bindEvents");function Vt(e,t,n){let o=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null);if(!t&&!n){for(;s.nextNode();)o.push(s.currentNode);return o}let f=t?.nextSibling||e.firstChild;if(!f)return o;s.currentNode=f;do{if(s.currentNode===n)break;o.push(s.currentNode)}while(s.nextNode());return o}i(Vt,"getElementsInRange");var ne=new Map;function Ye(e,t){let n=De(t);return ne.has(e)||ne.set(e,n.cloneNode(!0)),ne.get(e).cloneNode(!0)}i(Ye,"cachedTemplate");var oe=new WeakMap;function Ht(e){if(oe.has(e))return oe.get(e);try{let t=e()??null;return oe.set(e,t),t}catch{return null}}i(Ht,"evalExpr");function Ut(e,t,n,o){let s=t.nextSibling;if(s&&s.nodeType===Node.TEXT_NODE)s.textContent=String(o);else{Me(t,n);let f=document.createTextNode(String(o));n.parentNode.insertBefore(f,n)}}i(Ut,"renderEvaluated");function Wt(e,{signal:t,bindAttr:n,renderer:o}){let[s,f]=F(e.shadowRoot,n);!s||!f||L(e,t,c=>{o(s,f,c)})}i(Wt,"bindPlaceholderSignal");function Qe({host:e,type:t,signal:n,bindAttr:o}){Wt(e,{signal:n,bindAttr:o,renderer:i((s,f,c)=>{let u=t==="expression"?Ht(()=>c):c;u!=null&&Ut(e,s,f,u)},"renderer")})}i(Qe,"handleSignalBinding");var re=i(e=>e&&!/^(data_esor_|@|ref|key$)/.test(e)&&/^[a-z][\w\-_:]*$/i.test(e),"specialAttr");var q;function jt(e){return q||(q=document.createElement("textarea")),q.innerHTML=e,q.value}i(jt,"decodeHTMLEntities");function Ze(e){if(typeof e!="string")return e;e.indexOf("&")!==-1&&(e=jt(e));let t=e.trim();if(!t)return t;let n=t.toLowerCase(),o={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0};if(n in o)return o[n];let s=Number(t);if(!Number.isNaN(s))return s;try{return JSON.parse(t)}catch{return t}}i(Ze,"coerceAttrValue");function Lt(e){for(let{name:t,value:n}of e.attributes){if(!re(t))continue;let o=Ze(Se(n));e._props[t]=b(o)}}i(Lt,"generateSpecialAttrSignals");function qt(e){let t=i(o=>{for(let{attributeName:s}of o){if(!re(s))continue;let f=e._props[s];f&&f(Ze(e.getAttribute(s)))}},"handler"),n=new MutationObserver(t);n.observe(e,{attributes:!0}),e._cleanup.add(()=>n.disconnect())}i(qt,"observeAttrMutations");function et(e){Lt(e),qt(e)}i(et,"initPropsAndObserve");function tt(e,t){let o=class o extends HTMLElement{constructor(){super(),Ie(this),this._initEsorComponent(this),this._render()}_initEsorComponent(f){Object.assign(f,{_cleanup:new Set,_isUpdating:!1,_props:{},_eventIds:[],lifecycle:new C}),v.currentComponent=f,et(f),f.lifecycle.run("beforeMount",f)}connectedCallback(){this.lifecycle.run("mount",this)}disconnectedCallback(){this.lifecycle.run("destroy",this),this._cleanup.forEach(f=>f()),this._cleanup.clear(),this._eventIds.forEach(({type:f,id:c})=>Te(f,c)),this._eventIds=[]}_render(){R(this,()=>{this.lifecycle.run("beforeUpdate",this);let f=t.call(this,this._props),{template:c,signals:u,refs:g}=typeof f=="function"?f():f||{};this.shadowRoot.hasChildNodes()||this.shadowRoot.appendChild(Ye(e,c));let r=Oe(this.shadowRoot);r&&r.data_esor_ref&&Je(r.data_esor_ref,g),r&&r.data_esor_event&&Ge(this,r.data_esor_event),Ke(this,u),this.lifecycle.run("update",this)})}};i(o,"EsorComponent");let n=o;return customElements.define(e,n),n}i(tt,"component");function nt(e=null){let t=e;return new Proxy(()=>{},{apply:i((n,o,s)=>s.length?t=s[0]:t,"apply"),get:i((n,o)=>t&&(t[o]===void 0?t:t[o]),"get"),set:i((n,o,s)=>!!t&&(t[o]=s,!0),"set")})}i(nt,"ref");function ot(e,t=[]){let n=b(e());return y(()=>(n(e()),t)),n}i(ot,"memo");var ie="esor-store:",rt=i((e,t={})=>{let n=t.persist?zt(t.persist):null,o=b(n||e),s=new Set;return t.persist&&y(()=>{let c=i(u=>{if(u.key===ie+t.persist)try{o.set(JSON.parse(u.newValue))}catch(g){A(`Failed to sync state: ${g.message}`)}},"handleStorage");return window.addEventListener("storage",c),()=>window.removeEventListener("storage",c)}),[o,{setState(c){let u=typeof c=="function"?c(o()):c;o.set(u),t.persist&&Xt(t.persist,u),s.forEach(g=>g(u))},subscribe(c){return s.add(c),()=>s.delete(c)},getState:o}]},"store");function zt(e){try{let t=localStorage.getItem(ie+e);return t?JSON.parse(t):null}catch(t){return A(`Failed to load state: ${t.message}`),null}}i(zt,"loadFromStorage");function Xt(e,t){try{localStorage.setItem(ie+e,JSON.stringify(t))}catch(n){A(`Failed to save state: ${n.message}`)}}i(Xt,"saveToStorage");export{te as batch,pe as beforeMount,me as beforeUpdate,tt as component,M as computed,y as effect,Re as html,ot as memo,ve as onDestroy,Ee as onEffect,ge as onMount,he as onUpdate,nt as ref,b as signal,rt as store,be as useEmit};
//# sourceMappingURL=esor.min.js.map
