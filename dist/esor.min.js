var ae=Object.defineProperty;var fe=e=>{throw TypeError(e)};var ft=(e,t,n)=>t in e?ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var o=(e,t)=>ae(e,"name",{value:t,configurable:!0});var ue=(e,t,n)=>ft(e,typeof t!="symbol"?t+"":t,n),le=(e,t,n)=>t.has(e)||fe("Cannot "+n);var S=(e,t,n)=>(le(e,t,"read from private field"),n?n.call(e):t.get(e)),z=(e,t,n)=>t.has(e)?fe("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);var de=(e,t,n)=>(le(e,t,"access private method"),n);var x,k,he,$=class ${constructor(){z(this,k);z(this,x,new Map);$.current=this}add(t,n){return de(this,k,he).call(this,t).add(n),()=>S(this,x).get(t)?.delete(n)}run(t,n){queueMicrotask(()=>{let r=S(this,x).get(t);if(r?.size)for(let i of r)try{i.call(n)}catch(c){(typeof n._catchError=="function"?n._catchError:console.error)("Error in lifecycle hook:",c)}})}clear(t){t?S(this,x).delete(t):S(this,x).clear()}};x=new WeakMap,k=new WeakSet,he=o(function(t){return S(this,x).has(t)||S(this,x).set(t,new Set),S(this,x).get(t)},"#hooks"),o($,"Lifecycle"),ue($,"current");var C=$,pe=o(()=>C.current||(()=>{throw"Lifecycle not initialized"})(),"getLC"),[me,ge,Ee,ve,ye]=["beforeMount","mount","beforeUpdate","update","destroy"].map(e=>t=>pe().add(e,t)),Te=o(e=>{let t=e();return t instanceof Function&&pe().add("destroy",t)||(()=>{})},"onEffect");var B={currentEffect:null,currentComponent:null,pendingEffects:new Set,batchQueue:new Set,isEffectsFlushing:!1,globalEvents:{handlersByType:new Map,nextId:0}},g=B;function M(e,t){let n=B.currentComponent;B.currentComponent=e;try{return t()}finally{B.currentComponent=n}}o(M,"withCurrentComponent");var A=new WeakMap,ut=1;function xe(e,t,n){A.has(e)||A.set(e,new Map);let r=A.get(e),i=ut++;return r.set(i,{type:t,handler:n}),i}o(xe,"registerEvent");function be(e,t){return A.get(e)?.get(t)?.handler}o(be,"getEventHandler");function nn(e,t){let n=A.get(e);n&&(n.delete(t),n.size===0&&A.delete(e))}o(nn,"clearEventHandler");function Se(e){A.delete(e)}o(Se,"clearAllEventHandlers");var X=o(e=>e==null?"":e.toString().replace(/[&<>'"]/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;","/":"&#x2F;"})[t]),"escapeHTML");function Ae(e){return e==null?"":String(e).replace(/^["']|["']$/g,"").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}o(Ae,"cleanAttributeValue");var _e="$:",y="data_esor_event",J="data_esor_bind",K="data_esor_ref",lt=new RegExp(/\s(\w[\w-]*)=(["'])?(?:(?!\2).)*$/),Ne=new RegExp(/ref=(["'])?\s*$/),we=new RegExp(/(@\w+)=(["'])?\s*$/),dt=new RegExp(/["']\s*$/),pt=new RegExp(/^(script|style|textarea|title)$/i);function Ce(e,t,n,r){let i=e&&e.charAt(e.length-1)==='"'?'"':"'";return e.replace(t,`${n}=${i}${r}${i}`)}o(Ce,"replaceAttribute");var ht=o(e=>e.replace(dt,""),"removeQuote"),mt=o(e=>e?.template?.nodeType===Node.DOCUMENT_FRAGMENT_NODE,"isTemplateObject");function gt(e,t,n){let r=g.currentComponent,i=xe(r,t,e);return Ce(n,we,`${y}-${t}`,i)}o(gt,"injectEvent");function Et(e,t,n,r){return r.set(n,e),Ce(t,Ne,`${K}-${n}`,n)}o(Et,"injectRef");function vt(e,t,n,r,i){n=ht(n);let c=n&&n.charAt(n.length-1)==='"'?'"':"'",a=typeof e=="function"?e():e,u=pt.test(t)?String(a):X(a),p=`${J}-${r}`;return n+=`${c}${u}${c} ${p}=${c}true${c}`,i.set(r,{type:"attribute",signal:e,attributeName:t,bindAttr:p}),n}o(vt,"injectSignalAttr");function $e(e,t,n,r,i){let c=`${_e}${r}`;i.set(r,{type:t?"expression":"text",signal:e,bindAttr:c});let a=t?e():e;return`${n}<!--${c}-->${X(String(a))}<!--//${c}-->`}o($e,"injectExpr");function Me(e,t,n,r,i,c){let a=`${_e}${t}`,u={type:"array",signal:i?()=>(e.__signal()||[]).map(e.__mapFn||(f=>f)):typeof c=="function"?c:()=>e,bindAttr:a};n.set(t,u);let s=(Array.isArray(e)?e:[]).map(P).join("");return`${r}<!--${a}-->${s}<!--//${a}-->`}o(Me,"injectArray");function yt(e){let t="";for(let n of e.childNodes)n.nodeType===Node.ELEMENT_NODE&&n.hasAttribute("key")&&(n.setAttribute("data-key",n.getAttribute("key")),n.removeAttribute("key")),t+=n.outerHTML||n.textContent;return t}o(yt,"processTemplateNodes");function P(e){return e==null||e===!1?"":Array.isArray(e)?e.reduce((t,n)=>t+P(n),""):e instanceof SVGElement?e.outerHTML:mt(e)?yt(e.template):e?.type==="template-array"?e.templates.reduce((t,n)=>t+P(n),""):e.toString()}o(P,"processVal");function De(e,...t){let n="",r=new Map,i=new Map,c=0,a=0;for(let p=0;p<e.length;p++){if(n+=e[p],p>=t.length)continue;let s=t[p],f=e[p].match(lt),l=!!f,h=f?.[1],d=Ne.exec(n),m=we.exec(n),v=d&&typeof s=="function",w=m&&typeof s=="function",at=w?m[1].slice(1):null;v?n=Et(s,n,a++,i):w?n=gt(s,at,n):(s?.signal||typeof s=="function")&&l?n=vt(s,h,n,c++,r):Array.isArray(s)&&s.__signalArray===!0?n=Me(s,c++,r,n,!0):s?.signal?n=$e(s,!1,n,c++,r):typeof s=="function"?n=$e(s,!0,n,c++,r):Array.isArray(s)?n=Me(s,c++,r,n,!1,s):s!=null&&(n+=P(s))}let u=document.createElement("template");return u.innerHTML=n.trim(),{template:u.content,signals:r,refs:i}}o(De,"processTemplate");var G=new WeakMap;function Re(e,...t){if(t.length===0&&e.raw){if(G.has(e))return G.get(e);let n=De(e,...t);return G.set(e,n),n}return De(e,...t)}o(Re,"html");function hn(e,t){return!Object.is(e,t)}o(hn,"valuesChanged");var Ie=o(e=>e instanceof DocumentFragment&&e||e?.content?.cloneNode()||document.createDocumentFragment(),"getDocumentFragment");function Oe(e,t){let n=e.nextSibling;for(;n&&n!==t;){let r=n.nextSibling;n.parentNode.removeChild(n),n=r}}o(Oe,"removeChildNodesBetween");var V=new WeakMap;function F(e,t){if(V.has(e)){let a=V.get(e)[t];if(a)return a}let n=document.createTreeWalker(e,NodeFilter.SHOW_COMMENT),r=null,i=null;for(;n.nextNode()&&!i;){let a=n.currentNode;!r&&a.nodeValue===t?r=a:r&&a.nodeValue===`//${t}`&&(i=a)}let c=[r,i];return V.set(e,{...V.get(e),[t]:c}),c}o(F,"findCommentPlaceholders");function ke(e){let n=HTMLElement.prototype.hasOwnProperty("attachInternals")?e.attachInternals():null;n?.shadowRoot?e.shadowRoot=n.shadowRoot:e.attachShadow({mode:"open"})}o(ke,"setupDeclarativeShadowRoot");function Be(e,t=[K,y,J]){let n={},r=document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT,{acceptNode(c){if(c.hasAttributes()){for(let{name:a}of c.attributes)if(t.some(u=>a.startsWith(u)))return NodeFilter.FILTER_ACCEPT}return NodeFilter.FILTER_SKIP}}),i;for(;i=r.nextNode();)for(let c of i.attributes){let a=t.find(u=>c.name.startsWith(u));a&&(n[a]||(n[a]=[]),n[a].push(c))}return Object.keys(n).length?n:null}o(Be,"findAttributesWithEsorDirectives");var Pe=(e=>(e[e.Computed=1]="Computed",e[e.Effect=2]="Effect",e[e.Tracking=4]="Tracking",e[e.Notified=8]="Notified",e[e.Recursed=16]="Recursed",e[e.Dirty=32]="Dirty",e[e.PendingComputed=64]="PendingComputed",e[e.PendingEffect=128]="PendingEffect",e[e.Propagated=224]="Propagated",e))(Pe||{});function Ve({updateComputed:e,notifyEffect:t}){let n,r;return{link(s,f){let l=f.depsTail;if(l!==void 0&&l.dep===s)return;let h=l!==void 0?l.nextDep:f.deps;if(h!==void 0&&h.dep===s){f.depsTail=h;return}let d=s.subsTail;if(!(d!==void 0&&d.sub===f&&u(d,f)))return i(s,f,h,l)},propagate(s){let f=32,l=s,h=0;e:do{let d=s.sub,m=d.flags;if(!(m&244)&&(d.flags=m|f|8,!0)||m&16&&!(m&4)&&(d.flags=m&-17|f|8,!0)||!(m&224)&&u(s,d)&&(d.flags=m|16|f|8,d.subs!==void 0)){let v=d.subs;if(v!==void 0){v.nextSub!==void 0?(v.prevSub=l,s=l=v,f=64,++h):(s=v,f=m&2?128:64);continue}m&2&&(r!==void 0?r.depsTail.nextDep=d.deps:n=d,r=d)}else m&(4|f)?!(m&f)&&m&224&&u(s,d)&&(d.flags=m|f):(d.flags=m|f|8,(m&10)===2&&(r!==void 0?r.depsTail.nextDep=d.deps:n=d,r=d));if((s=l.nextSub)!==void 0){l=s,f=h?64:32;continue}for(;h;){--h;let w=l.dep.subs;if(l=w.prevSub,w.prevSub=void 0,(s=l.nextSub)!==void 0){l=s,f=h?64:32;continue e}}break}while(!0)},startTracking(s){s.depsTail=void 0,s.flags=s.flags&-249|4},endTracking(s){let f=s.depsTail;if(f!==void 0){let l=f.nextDep;l!==void 0&&(p(l),f.nextDep=void 0)}else s.deps!==void 0&&(p(s.deps),s.deps=void 0);s.flags&=-5},updateDirtyFlag(s,f){return c(s.deps)?(s.flags=f|32,!0):(s.flags=f&-65,!1)},processComputedUpdate(s,f){if((f&32||(c(s.deps)||(s.flags=f&-65,!1)))&&e(s)){let l=s.subs;l!==void 0&&a(l)}},processPendingInnerEffects(s,f){if(f&128){s.flags=f&-129;let l=s.deps;do{let h=l.dep;"flags"in h&&h.flags&2&&h.flags&224&&t(h),l=l.nextDep}while(l!==void 0)}},processEffectNotifications(){for(;n!==void 0;){let s=n,f=s.depsTail,l=f.nextDep;l!==void 0?(f.nextDep=void 0,n=l.sub):(n=void 0,r=void 0),t(s)||(s.flags&=-9)}}};function i(s,f,l,h){let d={dep:s,sub:f,nextDep:l,prevSub:void 0,nextSub:void 0};if(h===void 0?f.deps=d:h.nextDep=d,s.subs===void 0)s.subs=d;else{let m=s.subsTail;d.prevSub=m,m.nextSub=d}return f.depsTail=d,s.subsTail=d,d}function c(s){let f=0,l;e:do{l=!1;let h=s.dep;if("flags"in h){let d=h.flags;if((d&33)===33){if(e(h)){let m=h.subs;m.nextSub!==void 0&&a(m),l=!0}}else if((d&65)===65){let m=h.subs;m.nextSub!==void 0&&(m.prevSub=s),s=h.deps,++f;continue}}if(!l&&s.nextDep!==void 0){s=s.nextDep;continue}if(f){let d=s.sub;do{--f;let m=d.subs;if(l){if(e(d)){(s=m.prevSub)!==void 0?(m.prevSub=void 0,a(m),d=s.sub):d=m.sub;continue}}else d.flags&=-65;if((s=m.prevSub)!==void 0){if(m.prevSub=void 0,s.nextDep!==void 0){s=s.nextDep;continue e}d=s.sub}else{if((s=m.nextDep)!==void 0)continue e;d=m.sub}l=!1}while(f)}return l}while(!0)}function a(s){do{let f=s.sub,l=f.flags;(l&96)===64&&(f.flags=l|32|8,(l&10)===2&&(r!==void 0?r.depsTail.nextDep=f.deps:n=f,r=f)),s=s.nextSub}while(s!==void 0)}function u(s,f){let l=f.depsTail;if(l!==void 0){let h=f.deps;do{if(h===s)return!0;if(h===l)break;h=h.nextDep}while(h!==void 0)}return!1}function p(s){do{let f=s.dep,l=s.nextDep,h=s.nextSub,d=s.prevSub;if(h!==void 0?h.prevSub=d:f.subsTail=d,d!==void 0?d.nextSub=h:f.subs=h,f.subs===void 0&&"deps"in f){let m=f.flags;m&32||(f.flags=m|32);let v=f.deps;if(v!==void 0){s=v,f.depsTail.nextDep=l,f.deps=void 0,f.depsTail=void 0;continue}}s=l}while(s!==void 0)}}o(Ve,"createReactiveSystem");var{link:D,propagate:Tt,updateDirtyFlag:xt,startTracking:H,endTracking:U,processEffectNotifications:Fe,processComputedUpdate:bt,processPendingInnerEffects:He}=Ve({updateComputed(e){let t=E;E=e,H(e);try{let n=e.currentValue,r=e.getter(n);return n!==r?(e.currentValue=r,!0):!1}finally{E=t,U(e)}},notifyEffect(e){return"isScope"in e?Ct(e):wt(e)}}),Ue=[],Y=0,E,_;function Z(){++Y}o(Z,"startBatch");function ee(){--Y||Fe()}o(ee,"endBatch");function St(){Ue.push(E),E=void 0}o(St,"pauseTracking");function At(){E=Ue.pop()}o(At,"resumeTracking");function W(e){return Mt.bind({currentValue:e,subs:void 0,subsTail:void 0})}o(W,"signal");function R(e){return $t.bind({currentValue:void 0,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:33,getter:e})}o(R,"computed");function T(e){let t={fn:e,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:2};return E!==void 0?D(t,E):_!==void 0&&D(t,_),We(t),je.bind(t)}o(T,"effect");function _t(e){let t={deps:void 0,depsTail:void 0,flags:2,isScope:!0};return Nt(t,e),je.bind(t)}o(_t,"effectScope");function We(e){let t=E;E=e,H(e);try{e.fn()}finally{E=t,U(e)}}o(We,"runEffect");function Nt(e,t){let n=_;_=e,H(e);try{t()}finally{_=n,U(e)}}o(Nt,"runEffectScope");function wt(e){let t=e.flags;return t&32||t&64&&xt(e,t)?We(e):He(e,e.flags),!0}o(wt,"notifyEffect");function Ct(e){return e.flags&128?(He(e,e.flags),!0):!1}o(Ct,"notifyEffectScope");function $t(){let e=this.flags;return e&96&&bt(this,e),E!==void 0?D(this,E):_!==void 0&&D(this,_),this.currentValue}o($t,"computedGetter");function Mt(...e){if(e.length){if(this.currentValue!==(this.currentValue=e[0])){let t=this.subs;t!==void 0&&(Tt(t),Y||Fe())}}else return E!==void 0&&D(this,E),this.currentValue}o(Mt,"signalGetterSetter");function je(){H(this),U(this)}o(je,"effectStop");var te=new WeakMap;function j(e,t){if(e&&e.__signalArray===!0)return e;if(te.has(e))return te.get(e);let n=new Proxy(e,{get(r,i,c){let a=Reflect.get(r,i,c);return typeof a=="function"?function(...u){let p=a.apply(r,u);return Array.isArray(p)?(p.__signalArray=!0,p.__signal=t,u.length>0&&typeof u[0]=="function"&&(p.__mapFn=u[0]),j(p,t)):p}:a}});return te.set(e,n),n}o(j,"wrapArray");function b(e){if(Array.isArray(e)){let t=W(e),n=j(e,()=>t());return n.__signalArray=!0,o((...i)=>{if(i.length>0){let c=i[0];return t(c),n=j(c,()=>t()),n.__signalArray=!0,n}return n},"func")}return W(e)}o(b,"signal");function I(e){if(g.batchQueue)return e();g.batchQueue=new Set,Z();try{e(),Dt()}finally{ee(),g.batchQueue=null}}o(I,"batch");function Dt(){let e=g.batchQueue;g.batchQueue=null;for(let t of e)t();g.batchQueue.forEach(t=>t()),g.batchQueue.clear()}o(Dt,"flushBatch");function Xe(e,t,n=[],r=[],i){let c=[...n],a=[...r],u=t.parentNode,p=Rt(e,t),s=kt(a,p,c);c.length===a.length&&c.every((f,l)=>f===a[l])||I(()=>{Vt(u,p,s,t),Ge(i,e,t),e.__oldItems=[...a]})}o(Xe,"reconcileArrays");var Rt=o((e,t)=>{let n=[];for(let r=e.nextSibling;r&&r!==t;r=r.nextSibling)n.push(r);return n},"collectNodes"),O=o(e=>e&&e.nodeType===Node.ELEMENT_NODE,"isValidDOMNode"),It=o(e=>O(e)?e.getAttribute("data-key"):null,"getNodeKey");function Ot(e,t,n,r){if(!e||!t||!n?.template||!r?.template)return!1;e.firstChild?.nodeType===3&&e.normalize(),t.firstChild?.nodeType===3&&t.normalize();let i=Le(e),c=Le(t);if(i.length!==c.length)return!1;let a=!1;for(let u=0,p=i.length;u<p;u++)i[u].textContent!==c[u].textContent&&(i[u].textContent=c[u].textContent,a=!0);return a}o(Ot,"updateNodeContent");var Le=o(e=>{let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),r;for(;r=n.nextNode();)t.push(r);return t},"getTextNodes");function kt(e,t,n){let r=new Map,i=new Map,c=[];return t.forEach(a=>{let u=It(a);u&&r.set(u,a)}),n.forEach((a,u)=>i.set(Qe(a,u),a)),e.forEach((a,u)=>c[u]=Qe(a,u)),e.map((a,u)=>{let p=c[u],s=r.get(p),f=i.get(p);if(s?.nodeType===1){if(!f||Bt(f,a)){let l=ze(a,p);return Ot(s,l,f,a)?(Pt(s,l),s):l}return s}return ze(a,p)})}o(kt,"createOrReuseNodes");function Bt(e,t){if(!e||!t)return!0;if(e?.template&&t?.template){let n=qe(e),r=qe(t);return!L(n,r)}return!L(e,t)}o(Bt,"hasChanged");function qe(e){let{template:t}=e;if(!t)return null;let n=[],r=t.cloneNode(!0),i=document.createTreeWalker(r,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode(a){return a.nodeType===3?a.textContent.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}}),c;for(;c=i.nextNode();)if(c.nodeType===3)n.push(c.textContent);else for(let a=0,u=c.attributes.length;a<u;a++){let p=c.attributes[a].value;p.includes("${")&&n.push(p)}return n}o(qe,"extractDynamicValues");function L(e,t){if(e===t)return!0;if(!e||!t||typeof e!=typeof t)return!1;if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((n,r)=>L(n,t[r]));if(typeof e=="object"){let n=Object.keys(e),r=Object.keys(t);return n.length!==r.length?!1:n.every(i=>L(e[i],t[i]))}return String(e)===String(t)}o(L,"areValuesEqual");function Pt(e,t){if(!(!O(e)||!O(t)))for(let n=e.attributes.length-1;n>=0;n--){let r=e.attributes[n];r.name.startsWith(y)&&t.setAttribute(r.name,r.value)}}o(Pt,"copyEventAttributes");function Qe(e,t){if(e?.key!==void 0)return`key-${e.key}`;if(e?.template){let n=e.template.firstElementChild;if(e.id)return`item-${e.id}`;if(n&&O(n)){let r=n.getAttribute("key");if(r)return r}return`template-${t}`}if(e&&typeof e=="object"){if(e.id)return`item-${e.id}`;try{return`item-${t}-${JSON.stringify(e)}`}catch{return`item-${t}`}}return`item-${t}-${String(e)}`}o(Qe,"getItemKey");function ze(e,t){let n;return e?.template?n=e.template.cloneNode(!0).firstElementChild||document.createElement("div"):(n=document.createElement("div"),n.textContent=String(e)),O(n)&&n.setAttribute("data-key",t),n}o(ze,"createNode");var $n=o((e,t,n)=>e.insertBefore(t,n),"moveBefore");function Vt(e,t,n,r){let i=0,c=t.length,a=0,u=n.length,p=c>0?t[c-1].nextSibling:r,s=null;if(!c){for(let f=0;f<u;f++)e.insertBefore(n[f],p);return}if(!u){for(;i<c;)e.removeChild(t[i++]);return}for(;i<c||a<u;){if(t[i]===n[a]){i++,a++;continue}for(;t[c-1]===n[u-1];)c--,u--;if(i===c){let f=u<n.length?a?n[a-1].nextSibling:n[u-a]:p;for(;a<u;)e.insertBefore(n[a++],f)}else if(a===u)for(;i<c;)(!s||!s.has(t[i]))&&e.removeChild(t[i]),i++;else if(t[i]===n[u-1]&&n[a]===t[c-1]){let f=t[--c].nextSibling;e.insertBefore(n[a++],t[i++].nextSibling),e.insertBefore(n[--u],f),t[c]=n[u]}else{if(!s){s=new Map;for(let l=a;l<u;l++)s.set(n[l],l)}let f=s.get(t[i]);if(f==null)e.removeChild(t[i++]);else if(a<f&&f<u){let l=1;for(;i+l<c&&f+l<u&&t[i+l]===n[f+l];)l++;if(l>f-a){let h=t[i];for(;a<f;)e.insertBefore(n[a++],h)}else e.replaceChild(n[a++],t[i++])}else i++}}}o(Vt,"ddiff");function Je(e,t){let n=e?.shadowRoot;if(!n)return;let r=new Set;for(let i of t){let c=i.name.replace(`${y}-`,"");c&&r.add(c)}for(let i of r){let c=o(a=>{let u=a.target;if(u.hasAttribute(`${y}-${i}`)){let p=Number(u.getAttribute(`${y}-${i}`)),s=be(e,p);typeof s=="function"&&M(e,()=>{s.call(e,a)})}},"listener");n.addEventListener(i,c,{passive:!1,capture:!0}),e._eventHandlers=e._eventHandlers||new Map,e._eventHandlers.set(i,c)}}o(Je,"setupEventDelegation");function Ke(e,t){if(!(!e||!t))for(let n of e){let r=n.ownerElement;if(!r)continue;let i=Number(n.value);r.removeAttribute(n.name);let c=t.get(i);typeof c=="function"&&c(r)}}o(Ke,"setupRefs");function q(e,t,n){let r=T(()=>{if(!e._isUpdating){e._isUpdating=!0;try{n(t())}finally{e._isUpdating=!1}}});e._cleanup.add(r)}o(q,"bindSignalToElement");function Ye(e,t){if(!(!t||t.size===0))for(let{type:n,signal:r,bindAttr:i,attributeName:c}of t.values())switch(n){case"attribute":Ft(e,r,i,c);break;case"array":Ht(e,r,i);break;case"text":case"expression":Ze({host:e,type:n,signal:r,bindAttr:i});break}}o(Ye,"setupSignals");function Ft(e,t,n,r){let i=e.shadowRoot.querySelector(`[${n}]`);i&&(i.removeAttribute(n),q(e,t,c=>{let a=String(c);i.getAttribute(r)!==a&&i.setAttribute(r,a)}))}o(Ft,"handleAttributeSignal");function Ht(e,t,n){let[r,i]=F(e.shadowRoot,n);!r||!i||q(e,t,c=>{let a=r.__oldItems||[],u=Array.isArray(c)?c:[];Xe(r,i,a,u,e)})}o(Ht,"handleArraySignal");function Ge(e,t,n){let{shadowRoot:r}=e,i=Wt(r,t,n);Ut(e,i)}o(Ge,"bindEventsInRange");function Ut(e,t){for(let n of t)for(let r of Array.from(n.attributes)){if(!r.name.startsWith(`${y}`))continue;let i=r.name.replace(y,""),c=parseInt(r.value,10),a=g.globalEvents.handlersByType.get(i)?.get(c);typeof a=="function"&&(n.addEventListener(i,(...u)=>M(e,()=>a.call(e,...u))),n.removeAttribute(r.name))}}o(Ut,"bindEvents");function Wt(e,t,n){let r=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null);if(!t&&!n){for(;i.nextNode();)r.push(i.currentNode);return r}let c=t?.nextSibling||e.firstChild;if(!c)return r;i.currentNode=c;do{if(i.currentNode===n)break;r.push(i.currentNode)}while(i.nextNode());return r}o(Wt,"getElementsInRange");var ne=new Map;function et(e,t){let n=Ie(t);return ne.has(e)||ne.set(e,n.cloneNode(!0)),ne.get(e).cloneNode(!0)}o(et,"cachedTemplate");var re=new WeakMap;function jt(e){if(re.has(e))return re.get(e);try{let t=e()??null;return re.set(e,t),t}catch{return null}}o(jt,"evalExpr");function Lt(e,t,n,r){let i=t.nextSibling;if(i&&i.nodeType===Node.TEXT_NODE)i.textContent=String(r);else{Oe(t,n);let c=document.createTextNode(String(r));n.parentNode.insertBefore(c,n)}}o(Lt,"renderEvaluated");function qt(e,{signal:t,bindAttr:n,renderer:r}){let[i,c]=F(e.shadowRoot,n);!i||!c||q(e,t,a=>{r(i,c,a)})}o(qt,"bindPlaceholderSignal");function Ze({host:e,type:t,signal:n,bindAttr:r}){qt(e,{signal:n,bindAttr:r,renderer:o((i,c,a)=>{let u=t==="expression"?jt(()=>a):a;u!=null&&Lt(e,i,c,u)},"renderer")})}o(Ze,"handleSignalBinding");var oe=o(e=>e&&!/^(data_esor_|@|ref|key$)/.test(e)&&/^[a-z][\w\-_:]*$/i.test(e),"specialAttr");var Q;function Qt(e){return Q||(Q=document.createElement("textarea")),Q.innerHTML=e,Q.value}o(Qt,"decodeHTMLEntities");function tt(e){if(typeof e!="string")return e;e.indexOf("&")!==-1&&(e=Qt(e));let t=e.trim();if(!t)return t;let n=t.toLowerCase(),r={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0};if(n in r)return r[n];let i=Number(t);if(!Number.isNaN(i))return i;try{return JSON.parse(t)}catch{return t}}o(tt,"coerceAttrValue");function zt(e){for(let{name:t,value:n}of e.attributes){if(!oe(t))continue;let r=tt(Ae(n));e._props[t]=b(r)}}o(zt,"generateSpecialAttrSignals");function Xt(e){let t=o(r=>{for(let{attributeName:i}of r){if(!oe(i))continue;let c=e._props[i];c&&c(tt(e.getAttribute(i)))}},"handler"),n=new MutationObserver(t);n.observe(e,{attributes:!0}),e._cleanup.add(()=>n.disconnect())}o(Xt,"observeAttrMutations");function nt(e){zt(e),Xt(e)}o(nt,"initPropsAndObserve");function rt(e,t){let r=class r extends HTMLElement{constructor(){super(),ke(this),this._initEsorComponent(this),this._render()}_initEsorComponent(c){Object.assign(c,{_cleanup:new Set,_isUpdating:!1,_props:{},_eventIds:[],lifecycle:new C}),g.currentComponent=c,nt(c),c.lifecycle.run("beforeMount",c)}connectedCallback(){this.lifecycle.run("mount",this)}disconnectedCallback(){this.lifecycle.run("destroy",this),this._cleanup.forEach(c=>c()),this._cleanup.clear(),Se(this)}_render(){M(this,()=>{this.lifecycle.run("beforeUpdate",this);let c=t.call(this,this._props),{template:a,signals:u,refs:p}=typeof c=="function"?c():c||{};this.shadowRoot.hasChildNodes()||this.shadowRoot.appendChild(et(e,a));let s=Be(this.shadowRoot);s&&(s.data_esor_ref&&Ke(s.data_esor_ref,p),s.data_esor_event&&Je(this,s.data_esor_event)),Ye(this,u),this.lifecycle.run("update",this)})}};o(r,"EsorComponent");let n=r;return customElements.define(e,n),n}o(rt,"component");function ot(e=null){let t=e;return new Proxy(()=>{},{apply:o((n,r,i)=>i.length?t=i[0]:t,"apply"),get:o((n,r)=>t&&(t[r]===void 0?t:t[r]),"get"),set:o((n,r,i)=>!!t&&(t[r]=i,!0),"set")})}o(ot,"ref");function it(e,t=[]){let n=b(e());return T(()=>(n(e()),t)),n}o(it,"memo");var ie={info:{color:"#0066cc",icon:"\u2139\uFE0F"},warn:{color:"#FFA500",icon:"\u26A0\uFE0F"},error:{color:"#FF0000",icon:"\u{1F6AB}"}},se=o((e="info",t="",...n)=>{ie[e]||(e="info");let r=e.charAt(0).toUpperCase()+e.slice(1);console.groupCollapsed(`%c[ESOR ${ie[e].icon}${r}] ${t}`,`color: ${ie[e].color}; font-weight: bold;`),console[e]({message:t,component:g.currentComponent?.constructor?.name||"Unknown",time:new Date().toISOString(),data:n.length?n:void 0}),console[e==="error"?"trace":"debug"](),console.groupEnd()},"log"),lr=o((...e)=>se("info",...e),"info"),dr=o((...e)=>se("warn",...e),"warn"),N=o((...e)=>se("error",...e),"error");function st(e,t){let n=g.currentComponent;if(!n)return N("useEmit must be used within a component"),null;let r=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return r.__esor={name:e,detail:t,receivedBy:[],timestamp:Date.now()},n.dispatchEvent(r),r}o(st,"useEmit");var ce="esor-store:",ct=o((e,t={})=>{let n=t.persist?Gt(t.persist):null,r=b(n||e),i=new Set;return t.persist&&T(()=>{let a=o(u=>{if(u.key===ce+t.persist)try{r.set(JSON.parse(u.newValue))}catch(p){N(`Failed to sync state: ${p.message}`)}},"handleStorage");return window.addEventListener("storage",a),()=>window.removeEventListener("storage",a)}),[r,{setState(a){let u=typeof a=="function"?a(r()):a;r.set(u),t.persist&&Jt(t.persist,u),i.forEach(p=>p(u))},subscribe(a){return i.add(a),()=>i.delete(a)},getState:r}]},"store");function Gt(e){try{let t=localStorage.getItem(ce+e);return t?JSON.parse(t):null}catch(t){return N(`Failed to load state: ${t.message}`),null}}o(Gt,"loadFromStorage");function Jt(e,t){try{localStorage.setItem(ce+e,JSON.stringify(t))}catch(n){N(`Failed to save state: ${n.message}`)}}o(Jt,"saveToStorage");export{I as batch,me as beforeMount,Ee as beforeUpdate,rt as component,R as computed,T as effect,Re as html,it as memo,ye as onDestroy,Te as onEffect,ge as onMount,ve as onUpdate,ot as ref,b as signal,ct as store,st as useEmit};
//# sourceMappingURL=esor.min.js.map
