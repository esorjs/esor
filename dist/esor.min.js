var U=Object.defineProperty;var B=e=>{throw TypeError(e)};var ce=(e,t,n)=>t in e?U(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var r=(e,t)=>U(e,"name",{value:t,configurable:!0});var k=(e,t,n)=>ce(e,typeof t!="symbol"?t+"":t,n),$=(e,t,n)=>t.has(e)||B("Cannot "+n);var S=(e,t,n)=>($(e,t,"read from private field"),n?n.call(e):t.get(e)),w=(e,t,n)=>t.has(e)?B("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),T=(e,t,n,o)=>($(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);var h=null,ie=[],b=r(e=>{let t=e,n=[];return r(c=>{if(c===void 0)return h&&!n.includes(h)&&n.push(h),t;let l=typeof c=="function"?c(t):c;if(!Object.is(l,t)){t=l;let s=n.slice();for(let u=0;u<s.length;u++)s[u]()}return t},"getterSetter")},"signal"),a=r(e=>{let t=!1,n=r(()=>{if(t)return;t=!0;let o=h;h=n;try{e()}finally{h=o,t=!1}},"reactive");return n(),()=>subs.delete(n)},"effect"),O=r(e=>{let t=b();return a(()=>t(e())),()=>t()},"computed"),D=r(e=>{batchDepth++;try{return e()}finally{if(batchDepth--,batchDepth===0){let t=new Set;ie.forEach(n=>t.add(n)),t.forEach(n=>n())}}},"batch");function M(e,t,n=null){let o=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0,cancelable:!0});return n&&n.dispatchEvent(o),o}r(M,"emit");function V(e=null){let t=e;return n=>n!==void 0?t=n:t}r(V,"ref");var z=r(e=>e==null?"":String(e).replace(/[&<>'"]/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[t]),"sanitizeHtml");function H(e){return e&&(e.__nodeGroups=!0),e}r(H,"markNode");function E(e){return A(e,H)}r(E,"markedFragment");function A(e,t=null,n=null){let o=document.createDocumentFragment();if(!e?.length)return o;for(let c of e)c&&(c=typeof t=="function"?t(c,o):c,Array.isArray(c)?o.appendChild(A(c,t)):o.appendChild(c));return n&&o.childNodes.length&&n.appendChild(o),o}r(A,"createFragment");function X(e,t){if(!e||!t||!t.parentNode)return;let n=t.parentNode,o=r(i=>{for(let f of i)!f||f.parentNode!==n||(f._cleanup&&typeof f._cleanup=="function"&&f._cleanup(),n.removeChild(f))},"removeNodes"),c=r((i,f)=>i.length!==f.length||i.some((m,g)=>!m.isEqualNode(f[g])),"nodesChanged"),l=t.__nodeGroups||[],s=new Map(l.map(i=>[i.key,i])),u=e.map((i,f)=>{let m=Array.isArray(i)?i.filter(Boolean):[i];return{key:m.find(re=>re?.getAttribute?.("key")!=null)?.getAttribute("key")||`__key_${f}`,nodes:m}}),N=new Map(u.map(i=>[i.key,i]));for(let i of l)!N.has(i.key)&&o(i.nodes);let p=t;for(let i of u){let f=s.get(i.key);if(f)if(c(f.nodes,i.nodes))o(f.nodes),n.insertBefore(E(i.nodes),p.nextSibling);else{let m=p.nextSibling;if(f.nodes[0]!==m){let g=document.createDocumentFragment();for(let j of f.nodes)g.appendChild(j);n.insertBefore(g,m)}i.nodes=f.nodes}else n.insertBefore(E(i.nodes),p.nextSibling);p=i.nodes[i.nodes.length-1]||p}t.__nodeGroups=u}r(X,"reconcile");var F=new WeakMap,x="\uFEFF";function G(e){let t=document.createElement("template");return t.innerHTML=e,t}r(G,"createTemplate");var L=r((e,t,n)=>{if(t)if(e.removeAttribute(t),t==="ref")typeof n=="function"?n(e):n&&(n.current=e);else if(t[0]=="o"&&t[1]=="n"&&typeof n=="function"){let o=t.slice(2).toLowerCase();e.addEventListener(o,n),e._cleanup=()=>e.removeEventListener(o,n)}else t==="style"&&typeof n=="object"?a(()=>Object.assign(e.style,n)):typeof n=="function"?a(()=>q(e,t,n())):q(e,t,n);else se(e,n)},"render");function q(e,t,n){t==="value"||t==="checked"?e[t]=n:n===!1||n===null||n===void 0?e.removeAttribute(t):e.setAttribute(t,n)}r(q,"setAttribute");function se(e,t){let n=r(o=>{if(typeof o=="boolean"&&(o=""),Array.isArray(o))X(o,e);else{let c=document.createTextNode(z(typeof o=="string"?o:String(o??"")));H(c),fe(e,[c])}},"updateContent");typeof t=="function"?a(()=>n(t())):n(t)}r(se,"setContent");function fe(e,t){let n=e.parentNode,o=e.nextSibling;for(;o&&o.__nodeGroups;)o._cleanup&&o._cleanup(),n.removeChild(o),o=e.nextSibling;t?.length&&ue(E(t),n,e.nextSibling)}r(fe,"replaceNodes");function ue(e,t,n=null){!e||!t||(n&&n.parentNode===t?t.insertBefore(e,n):t.appendChild(e))}r(ue,"insertFragment");function le(e,t){let n=[],o=document.createTreeWalker(e.content,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);for(;o.nextNode();)n.push(o.currentNode);let c=0;for(let l=0;l<n.length;l++){let s=n[l];if(s.nodeType===Node.ELEMENT_NODE&&s.attributes.length)for(let u of Array.from(s.attributes))u.value===x&&L(s,u.name,t[c++]);else if(s.nodeType===Node.TEXT_NODE&&s.nodeValue.includes(x))if(s.nodeValue===x){let u=document.createComment("");s.parentNode.replaceChild(u,s),L(u,null,t[c++])}else{let u=G(s.nodeValue.replaceAll(x,"<!>")),N=Array.from(u.content.childNodes);for(let p=0;p<N.length;p++){let i=N[p];i.nodeType===Node.COMMENT_NODE&&L(i,null,t[c++])}s.parentNode.replaceChild(u.content,s)}}}r(le,"processTemplate");function P(e,t=null){let n=G(e);return typeof t=="function"&&t(n),[...n.content.childNodes]}r(P,"templateToNodes");function I(e,...t){if(e.length===1)return P(e[0]);if(!t.length)return P(e.join(""));let n=e.join(x),o=G(n);return le(o,t),[...o.content.childNodes]}r(I,"build");function W(e,...t){return F.has(e)?I(F.get(e),...t):(F.set(e,e),I(e,...t))}r(W,"html");function _(e,t,n="error"){let o=n==="warn"?console.warn:console.error,c=t instanceof Error?t:new Error(String(t));return o(`[Esor Error] ${e}:`,c.message),c}r(_,"handleError");var d=null,J=r(e=>d=e,"createLifecycle"),y=r((e,t)=>{if(!d){_("lifecycle","Hook called outside component setup");return}d._lifecycles[e]||(d._lifecycles[e]=[]),d._lifecycles[e].push(t)},"addHook"),C=r(e=>{if(d?._lifecycles?.[e])for(let t of d._lifecycles[e])queueMicrotask(()=>t.call(d),"lifecycle.runHook")},"runHook"),Q=r(e=>{let t=e();return typeof t=="function"?y("destroy",t):()=>{}},"onEffect"),Y=r(e=>y("beforeMount",e),"beforeMount"),Z=r(e=>y("mount",e),"onMount"),R=r(e=>y("beforeUpdate",e),"beforeUpdate"),K=r(e=>y("update",e),"onUpdate"),v=r(e=>y("destroy",e),"onDestroy");var pe=/^-?\d+(?:\.\d+)?(?:e[+-]?\d+)?$/;function ee(e){return e==null?"":e==="true"?!0:e==="false"?!1:pe.test(e)?Number(e):typeof e=="string"&&(e[0]==="{"||e[0]==="[")?JSON.parse(e):e}r(ee,"parseAttributeValue");function te(e){for(let n of e.attributes){let{name:o,value:c}=n;o.startsWith("on")||o.startsWith("ref")||(e.props[o]=b(ee(c)))}let t=new MutationObserver(n=>{for(let o of n){let c=o.attributeName;if(!c||c.startsWith("on")||c.startsWith("ref"))continue;let l=e.props[c];l&&l(ee(e.getAttribute(c)))}});t.observe(e,{attributes:!0}),e._cleanup.push(()=>t.disconnect())}r(te,"initPropsAndObserve");function ne(e){e&&(e.emit=(t,n)=>M(t,n,e))}r(ne,"initDispatch");var ae=/^[a-z][a-z0-9-]*$/,de="open",me=r((e,t={})=>{var n,o,c;return c=class extends HTMLElement{constructor(){super();w(this,n,this.attachShadow({mode:t.mode||de}));w(this,o,!1);k(this,"props",Object.create(null));k(this,"_lifecycles",{beforeMount:[],mount:[],beforeUpdate:[],update:[],destroy:[]});k(this,"_cleanup",[]);J(this),ne(this),te(this);let s=e?.call(this,this.props);A(s||[s],null,S(this,n)),C("beforeMount")}connectedCallback(){S(this,o)||(T(this,o,!0),C("mount"))}disconnectedCallback(){C("destroy"),this._cleanup.forEach(s=>s()),this._cleanup=[],T(this,o,!1)}},n=new WeakMap,o=new WeakMap,c},"BaseComponent"),oe=r((e,t,n={})=>{if(!(typeof customElements>"u")){if(!ae.test(e))return _("component",`Invalid tag name: ${e}`,"error");if(customElements.get(e))return _("component",`${e} already registered`,"warn");customElements.define(e,me(t,n))}},"component");export{D as batch,Y as beforeMount,R as beforeUpdate,oe as component,O as computed,a as effect,M as emit,W as html,v as onDestroy,Q as onEffect,Z as onMount,K as onUpdate,V as ref,b as signal};
//# sourceMappingURL=esor.min.js.map
